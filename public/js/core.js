/**
 * ==============================================
 *   C√≥digo Protegido com Sistema de Obfusca√ß√£o
 *        e IIFE (Immediately Invoked Function Expression)
 * ==============================================
 * 
 * Este bloco de c√≥digo foi encapsulado dentro de uma IIFE para garantir 
 * que suas vari√°veis e fun√ß√µes internas n√£o sejam acess√≠veis no escopo global. 
 * Al√©m disso, foi aplicado um processo de obfusca√ß√£o para aumentar a seguran√ßa 
 * e dificultar tentativas de engenharia reversa, leitura ou modifica√ß√£o indevida.
 * 
 * O processo de obfusca√ß√£o inclui:
 * 1. **Renomea√ß√£o de Vari√°veis e Fun√ß√µes**: Todas as vari√°veis e fun√ß√µes 
 *    foram renomeadas para vers√µes criptografadas ou aleat√≥rias, dificultando a leitura.
 * 
 * 2. **Minifica√ß√£o**: O c√≥digo foi compactado ao m√°ximo, removendo espa√ßos 
 *    em branco, coment√°rios e linhas desnecess√°rias, reduzindo o tamanho do arquivo 
 *    e a legibilidade humana.
 * 
 * 3. **Codifica√ß√£o de Strings**: Todas as strings internas foram codificadas ou 
 *    criptografadas para evitar a f√°cil extra√ß√£o de dados sens√≠veis.
 * 
 * 4. **Encapsulamento via IIFE**: A IIFE protege o c√≥digo contra interfer√™ncias 
 *    externas e limita o acesso ao escopo interno, preservando a integridade da l√≥gica.
 * 
 * AVISO: Se voc√™ veio aqui pra tentar obter a √≠ndice da resposta correta, ta perdendo seu tempo üòÇ.
 * 
 * ==============================================
 */

(function() {
  const quizData = [
    {
      "category": "Seguran√ßa",
      "question": "Qual a fun√ß√£o de um firewall?",
      "answers": ["Bloquear acessos n√£o autorizados", "Armazenar dados", "Processar informa√ß√µes"],
      "correct": 0,
      "explanation": "Um firewall monitora e controla o tr√°fego de rede baseado em regras de seguran√ßa predefinidas."
    },
    {
      "category": "Hardware",
      "question": "Qual componente √© considerado o c√©rebro do computador?",
      "answers": ["Mem√≥ria RAM", "CPU", "Disco R√≠gido"],
      "correct": 1,
      "explanation": "A CPU (Unidade Central de Processamento) executa instru√ß√µes e processa dados."
    },
    {
      "category": "Software",
      "question": "O que √© um sistema operacional?",
      "answers": ["Um tipo de hardware", "Um software que gerencia recursos do computador", "Uma aplica√ß√£o de produtividade"],
      "correct": 1,
      "explanation": "Um sistema operacional gerencia os recursos do computador e fornece servi√ßos para outros softwares."
    },
    {
      "category": "Redes",
      "question": "O que significa IP na √°rea de redes?",
      "answers": ["Internet Protocol", "Internal Process", "Interactive Platform"],
      "correct": 0,
      "explanation": "IP significa Internet Protocol, que √© um conjunto de regras para comunica√ß√£o de dados."
    },
    {
      "category": "Programa√ß√£o",
      "question": "Qual dessas linguagens √© utilizada para desenvolvimento web front-end?",
      "answers": ["Python", "JavaScript", "C++"],
      "correct": 1,
      "explanation": "JavaScript √© amplamente utilizada para desenvolvimento web front-end."
    },
    {
      "category": "Banco de Dados",
      "question": "O que significa SQL?",
      "answers": ["Structured Query Language", "Simple Query Language", "Sequential Query Logic"],
      "correct": 0,
      "explanation": "SQL significa Structured Query Language, usada para gerenciar e manipular bancos de dados relacionais."
    },
    {
      "category": "Banco de Dados",
      "question": "Qual √© a finalidade de uma chave prim√°ria em um banco de dados?",
      "answers": ["Garantir unicidade das linhas", "Armazenar dados de backup", "Indexar colunas para pesquisa"],
      "correct": 0,
      "explanation": "A chave prim√°ria garante que cada linha da tabela seja √∫nica e identifica cada registro de forma exclusiva."
    },
    {
      "category": "Sistemas Operacionais",
      "question": "Qual desses √© um sistema operacional baseado em Unix?",
      "answers": ["Windows", "macOS", "MS-DOS"],
      "correct": 1,
      "explanation": "O macOS √© um sistema operacional baseado em Unix, derivado do sistema NeXTSTEP."
    },
    {
      "category": "Hardware",
      "question": "O que √© a mem√≥ria RAM?",
      "answers": ["Mem√≥ria de armazenamento permanente", "Mem√≥ria tempor√°ria que armazena dados em uso", "Mem√≥ria somente leitura"],
      "correct": 1,
      "explanation": "A mem√≥ria RAM armazena dados temporariamente enquanto o computador est√° em uso."
    },
    {
      "category": "Programa√ß√£o",
      "question": "Qual desses √© um paradigma de programa√ß√£o?",
      "answers": ["Estrutural", "Linear", "Exponencial"],
      "correct": 0,
      "explanation": "A programa√ß√£o estrutural √© um paradigma de programa√ß√£o focado no uso de estruturas de controle."
    },
    {
      "category": "Redes",
      "question": "O que significa DNS?",
      "answers": ["Domain Name System", "Data Network System", "Direct Name Service"],
      "correct": 0,
      "explanation": "DNS significa Domain Name System e √© respons√°vel por traduzir nomes de dom√≠nio em endere√ßos IP."
    },
    {
      "category": "Seguran√ßa",
      "question": "O que √© phishing?",
      "answers": ["Um tipo de v√≠rus de computador", "Uma tentativa de obter informa√ß√µes pessoais fraudulentamente", "Uma t√©cnica de prote√ß√£o de dados"],
      "correct": 1,
      "explanation": "Phishing √© uma pr√°tica fraudulenta de obter informa√ß√µes pessoais se passando por uma entidade confi√°vel."
    },
    {
      "category": "Software",
      "question": "Qual √© a fun√ß√£o de um compilador?",
      "answers": ["Executar programas", "Converter c√≥digo fonte em c√≥digo m√°quina", "Gerenciar o hardware"],
      "correct": 1,
      "explanation": "Um compilador converte o c√≥digo fonte de uma linguagem de programa√ß√£o para um c√≥digo execut√°vel."
    },
    {
      "category": "Banco de Dados",
      "question": "Qual √© a linguagem usada para consultas a bancos de dados relacionais?",
      "answers": ["HTML", "CSS", "SQL"],
      "correct": 2,
      "explanation": "SQL √© a linguagem padr√£o usada para consultas a bancos de dados relacionais."
    },
    {
      "category": "Redes",
      "question": "O que √© um roteador?",
      "answers": ["Um dispositivo que conecta redes diferentes e encaminha pacotes", "Um dispositivo de armazenamento", "Uma impressora de rede"],
      "correct": 0,
      "explanation": "Um roteador √© usado para conectar redes diferentes e encaminhar pacotes de dados entre elas."
    },
    {
      "category": "Seguran√ßa",
      "question": "O que √© criptografia?",
      "answers": ["A t√©cnica de codificar informa√ß√µes para proteg√™-las", "A elimina√ß√£o de dados desnecess√°rios", "A compress√£o de arquivos"],
      "correct": 0,
      "explanation": "Criptografia √© o processo de converter dados leg√≠veis em uma forma codificada para proteg√™-los."
    },
    {
      "category": "Hardware",
      "question": "O que faz uma placa-m√£e?",
      "answers": ["Armazena informa√ß√µes", "Interconecta os componentes do computador", "Realiza o processamento gr√°fico"],
      "correct": 1,
      "explanation": "A placa-m√£e √© respons√°vel por interconectar os componentes e permitir a comunica√ß√£o entre eles."
    },
    {
      "category": "Programa√ß√£o",
      "question": "O que significa IDE em programa√ß√£o?",
      "answers": ["Integrated Development Environment", "Internal Data Editor", "Initial Development Entry"],
      "correct": 0,
      "explanation": "IDE significa Integrated Development Environment e √© um ambiente que facilita o desenvolvimento de software."
    },
    {
      "category": "Redes",
      "question": "Qual √© a fun√ß√£o de um switch em uma rede?",
      "answers": ["Redirecionar o tr√°fego de rede de acordo com endere√ßos MAC", "Converter sinais digitais", "Controlar o acesso √† internet"],
      "correct": 0,
      "explanation": "Um switch √© respons√°vel por redirecionar o tr√°fego de rede com base nos endere√ßos MAC dos dispositivos conectados."
    },
    {
      "category": "Software",
      "question": "O que √© software livre?",
      "answers": ["Software dispon√≠vel gratuitamente e que pode ser modificado", "Software que n√£o precisa ser instalado", "Software sem licen√ßa"],
      "correct": 0,
      "explanation": "Software livre √© um software que pode ser utilizado, modificado e distribu√≠do livremente."
    },
    {
      "category": "Hardware",
      "question": "O que √© um SSD?",
      "answers": ["Um tipo de mem√≥ria vol√°til", "Um tipo de disco de armazenamento n√£o vol√°til", "Um processador gr√°fico"],
      "correct": 1,
      "explanation": "Um SSD (Solid State Drive) √© um tipo de dispositivo de armazenamento que usa mem√≥ria flash."
    },
    {
      "category": "Seguran√ßa",
      "question": "O que √© autentica√ß√£o de dois fatores (2FA)?",
      "answers": ["Um m√©todo de login usando duas camadas de prote√ß√£o", "Uma t√©cnica para hackear sistemas", "Uma forma de criptografar dados"],
      "correct": 0,
      "explanation": "Autentica√ß√£o de dois fatores √© uma camada adicional de seguran√ßa exigindo duas formas de verifica√ß√£o ao fazer login."
    },
    {
      "category": "Programa√ß√£o",
      "question": "Qual desses √© um framework JavaScript?",
      "answers": ["Angular", "Ruby", "PHP"],
      "correct": 0,
      "explanation": "Angular √© um framework popular para desenvolvimento de aplicativos web em JavaScript."
    },
    {
      "category": "Banco de Dados",
      "question": "O que √© normaliza√ß√£o em bancos de dados?",
      "answers": ["O processo de organizar dados para minimizar redund√¢ncia", "A cria√ß√£o de backups autom√°ticos", "A indexa√ß√£o de tabelas para melhorar a velocidade"],
      "correct": 0,
      "explanation": "Normaliza√ß√£o √© o processo de organizar dados em um banco de dados para reduzir redund√¢ncias e melhorar a integridade."
    },
    {
      "category": "Redes",
      "question": "O que significa HTTP?",
      "answers": ["HyperText Transfer Protocol", "HyperText Transmission Process", "HyperThread Transfer Protocol"],
      "correct": 0,
      "explanation": "HTTP significa HyperText Transfer Protocol e √© o protocolo usado para transferir dados na web."
    },
    {
      "category": "Hardware",
      "question": "O que √© um barramento (bus) em um computador?",
      "answers": ["Uma rede local de computadores", "Um conjunto de linhas de comunica√ß√£o que transferem dados entre componentes", "Um tipo de mem√≥ria n√£o vol√°til"],
      "correct": 1,
      "explanation": "O barramento √© um conjunto de linhas de comunica√ß√£o usado para transferir dados entre os componentes do computador."
    },
    {
      "category": "Software",
      "question": "Qual √© a principal diferen√ßa entre software propriet√°rio e software livre?",
      "answers": ["O software propriet√°rio n√£o pode ser modificado ou distribu√≠do livremente", "O software livre √© mais caro", "Software propriet√°rio √© sempre mais seguro"],
      "correct": 0,
      "explanation": "O software propriet√°rio √© protegido por direitos autorais, o que impede a modifica√ß√£o e distribui√ß√£o sem autoriza√ß√£o."
    },
    {
      "category": "Programa√ß√£o",
      "question": "Qual √© a principal fun√ß√£o de um algoritmo?",
      "answers": ["Solucionar problemas de forma sequencial", "Gerar n√∫meros aleat√≥rios", "Compilar c√≥digos"],
      "correct": 0,
      "explanation": "Um algoritmo √© um conjunto de passos l√≥gicos usados para resolver problemas."
    },
    {
      "category": "Redes",
      "question": "O que √© um endere√ßo MAC?",
      "answers": ["Um identificador √∫nico atribu√≠do a dispositivos de rede", "Um tipo de endere√ßo IP", "Um tipo de roteador"],
      "correct": 0,
      "explanation": "Um endere√ßo MAC √© um identificador √∫nico atribu√≠do a dispositivos de rede para comunica√ß√£o em uma rede."
    },
    {
      "category": "Seguran√ßa",
      "question": "O que √© malware?",
      "answers": ["Qualquer software projetado para causar danos ao computador ou rede", "Um programa para prote√ß√£o contra v√≠rus", "Um software livre de licen√ßa"],
      "correct": 0,
      "explanation": "Malware √© qualquer software malicioso que pode danificar ou invadir sistemas e redes."
    },
    {
      "category": "Hardware",
      "question": "Qual √© a fun√ß√£o de um processador gr√°fico (GPU)?",
      "answers": ["Renderizar gr√°ficos e imagens", "Gerenciar o tr√°fego de rede", "Processar dados matem√°ticos"],
      "correct": 0,
      "explanation": "Uma GPU (Unidade de Processamento Gr√°fico) √© usada para renderizar gr√°ficos e imagens em alta velocidade."
    },
    {
      "category": "Programa√ß√£o",
      "question": "Qual √© a sintaxe correta para criar uma fun√ß√£o em JavaScript?",
      "answers": ["function nomeFuncao() {}", "def nomeFuncao():", "function = nomeFuncao{}"],
      "correct": 0,
      "explanation": "A sintaxe correta para criar uma fun√ß√£o em JavaScript √© 'function nomeFuncao() {}'."
    },
    {
      "category": "Banco de Dados",
      "question": "O que √© uma tabela em um banco de dados relacional?",
      "answers": ["Um conjunto de registros organizados em linhas e colunas", "Um script para consultar dados", "Um √≠ndice de consulta"],
      "correct": 0,
      "explanation": "Uma tabela em um banco de dados relacional √© um conjunto de dados organizados em linhas e colunas."
    },
    {
      "category": "Redes",
      "question": "O que significa VPN?",
      "answers": ["Virtual Private Network", "Virtual Process Node", "Very Private Network"],
      "correct": 0,
      "explanation": "VPN significa Virtual Private Network e √© usada para criar uma conex√£o segura sobre uma rede p√∫blica."
    },
    {
      "category": "Seguran√ßa",
      "question": "O que √© ransomware?",
      "answers": ["Um tipo de malware que exige resgate para liberar o sistema infectado", "Um software de backup", "Uma t√©cnica de compress√£o de arquivos"],
      "correct": 0,
      "explanation": "Ransomware √© um tipo de malware que bloqueia o acesso ao sistema at√© que um resgate seja pago."
    },
    {
      "category": "Hardware",
      "question": "Qual √© a fun√ß√£o de uma fonte de alimenta√ß√£o (PSU)?",
      "answers": ["Converter corrente alternada em corrente cont√≠nua para alimentar os componentes", "Fornecer energia direta ao processador", "Controlar a voltagem da mem√≥ria RAM"],
      "correct": 0,
      "explanation": "A fonte de alimenta√ß√£o converte a corrente alternada (AC) em corrente cont√≠nua (DC) para alimentar os componentes do computador."
    },
    {
      "category": "Programa√ß√£o",
      "question": "Qual dessas √© uma linguagem de programa√ß√£o orientada a objetos?",
      "answers": ["Java", "HTML", "CSS"],
      "correct": 0,
      "explanation": "Java √© uma linguagem de programa√ß√£o orientada a objetos, usada amplamente no desenvolvimento de software."
    },
    {
      "category": "Redes",
      "question": "O que √© o protocolo FTP usado para?",
      "answers": ["Transferir arquivos pela internet", "Criptografar dados em redes", "Atribuir endere√ßos IP"],
      "correct": 0,
      "explanation": "FTP (File Transfer Protocol) √© usado para transferir arquivos entre computadores na internet."
    },
    {
      "category": "Seguran√ßa",
      "question": "Qual √© a fun√ß√£o de um antiv√≠rus?",
      "answers": ["Detectar e remover softwares maliciosos", "Proteger dados contra perda", "Aumentar a velocidade do processador"],
      "correct": 0,
      "explanation": "Um antiv√≠rus √© um software que detecta e remove v√≠rus e outros malwares de um sistema."
    },
    {
      "category": "Hardware",
      "question": "O que √© overclocking?",
      "answers": ["Aumentar a frequ√™ncia de opera√ß√£o de um componente acima de suas especifica√ß√µes originais", "Diminuir a temperatura da CPU", "Aumentar a capacidade de armazenamento de um disco r√≠gido"],
      "correct": 0,
      "explanation": "Overclocking √© o ato de aumentar a frequ√™ncia de opera√ß√£o de um componente, como a CPU, al√©m de suas especifica√ß√µes normais."
    },
    {
      "category": "Programa√ß√£o",
      "question": "O que √© um loop em programa√ß√£o?",
      "answers": ["Uma estrutura que repete um bloco de c√≥digo at√© que uma condi√ß√£o seja atendida", "Um tipo de vari√°vel", "Uma fun√ß√£o matem√°tica complexa"],
      "correct": 0,
      "explanation": "Um loop √© uma estrutura que repete a execu√ß√£o de um bloco de c√≥digo at√© que uma condi√ß√£o espec√≠fica seja satisfeita."
    },
    {
      "category": "Redes",
      "question": "Qual √© o papel de um proxy em uma rede?",
      "answers": ["Atuar como intermedi√°rio entre o cliente e o servidor", "Atribuir endere√ßos IP", "Detectar amea√ßas de malware"],
      "correct": 0,
      "explanation": "Um proxy atua como intermedi√°rio entre um cliente e um servidor, controlando e filtrando o tr√°fego de rede."
    },
    {
      "category": "Seguran√ßa",
      "question": "O que √© ransomware?",
      "answers": ["Um tipo de malware que exige resgate para liberar o sistema", "Um software de prote√ß√£o contra v√≠rus", "Uma ferramenta de gerenciamento de senhas"],
      "correct": 0,
      "explanation": "Ransomware √© um tipo de malware que bloqueia o acesso ao sistema ou arquivos e exige um pagamento para liber√°-los."
    },
    {
      "category": "Hardware",
      "question": "Qual √© a fun√ß√£o de uma fonte de alimenta√ß√£o em um computador?",
      "answers": ["Armazenar dados", "Converter energia el√©trica para alimentar os componentes", "Controlar a temperatura do sistema"],
      "correct": 1,
      "explanation": "A fonte de alimenta√ß√£o converte energia el√©trica da tomada em uma forma utiliz√°vel para os componentes do computador."
    },
    {
      "category": "Programa√ß√£o",
      "question": "O que √© um bug em programa√ß√£o?",
      "answers": ["Um erro ou falha em um programa", "Uma nova funcionalidade", "Um tipo de sistema operacional"],
      "correct": 0,
      "explanation": "Um bug √© um erro ou falha em um programa que pode causar comportamentos inesperados."
    },
    {
      "category": "Banco de Dados",
      "question": "O que √© uma consulta em SQL?",
      "answers": ["Uma opera√ß√£o para recuperar dados de um banco de dados", "Um comando para excluir dados", "Um tipo de tabela"],
      "correct": 0,
      "explanation": "Uma consulta em SQL √© uma opera√ß√£o que recupera dados de um banco de dados com base em crit√©rios especificados."
    },
    {
      "category": "Redes",
      "question": "Qual √© a principal fun√ß√£o do protocolo TCP?",
      "answers": ["Garantir a entrega confi√°vel de dados", "Controlar o acesso √† internet", "Converter endere√ßos IP em nomes de dom√≠nio"],
      "correct": 0,
      "explanation": "O protocolo TCP (Transmission Control Protocol) garante a entrega confi√°vel de dados na comunica√ß√£o pela internet."
    },
    {
      "category": "Seguran√ßa",
      "question": "O que √© engenharia social?",
      "answers": ["Manipula√ß√£o de pessoas para obter informa√ß√µes confidenciais", "Um m√©todo de programa√ß√£o", "Uma t√©cnica de seguran√ßa de rede"],
      "correct": 0,
      "explanation": "Engenharia social refere-se √† manipula√ß√£o de indiv√≠duos para que revelem informa√ß√µes confidenciais."
    },
    {
      "category": "Software",
      "question": "Qual √© a diferen√ßa entre um aplicativo nativo e um aplicativo web?",
      "answers": ["Aplicativos nativos s√£o instalados no dispositivo, enquanto aplicativos web s√£o acessados pelo navegador", "Aplicativos nativos s√£o mais lentos que aplicativos web", "N√£o h√° diferen√ßa"],
      "correct": 0,
      "explanation": "Aplicativos nativos s√£o desenvolvidos para um sistema operacional espec√≠fico e instalados no dispositivo, enquanto aplicativos web s√£o acessados atrav√©s de navegadores."
    },
    {
      "category": "Programa√ß√£o",
      "question": "O que significa OOP?",
      "answers": ["Programa√ß√£o Orientada a Objetos", "Opera√ß√£o de Objeto Programado", "Organiza√ß√£o de Objetos em Projetos"],
      "correct": 0,
      "explanation": "OOP significa Programa√ß√£o Orientada a Objetos, um paradigma de programa√ß√£o baseado na utiliza√ß√£o de objetos."
    },
    {
      "category": "Hardware",
      "question": "Qual √© a fun√ß√£o de um cooler em um computador?",
      "answers": ["Aumentar a velocidade do processador", "Resfriar os componentes para evitar superaquecimento", "Aumentar a mem√≥ria RAM"],
      "correct": 1,
      "explanation": "Um cooler √© usado para resfriar os componentes do computador, evitando que eles superaque√ßam."
    },
    {
      "category": "Redes",
      "question": "O que √© um servidor?",
      "answers": ["Um computador que fornece servi√ßos a outros computadores", "Um dispositivo de armazenamento", "Um tipo de firewall"],
      "correct": 0,
      "explanation": "Um servidor √© um computador que fornece servi√ßos e recursos a outros computadores na rede."
    }
  ];

  let questions = [...quizData];
  shuffle(questions);
  let currentQuestion = 0;
  let score = 0;
  let categoryStats = {};
  let correctAnswerIndex = -1;

  const startQuizBtn = document.getElementById("startQuiz");
  const quizContainer = document.getElementById("quizContainer");
  const questionEl = document.getElementById("question");
  const answersEl = document.getElementById("answers");
  const explanationEl = document.getElementById("explanation");
  const explanationTextEl = document.getElementById("explanationText");
  const nextQuestionBtn = document.getElementById("nextQuestion");
  const resultEl = document.getElementById("result");
  const scoreEl = document.getElementById("score");
  const percentageEl = document.getElementById("percentage");
  const restartQuizBtn = document.getElementById("restartQuiz");
  const questionChip = document.getElementById("questionChip");
  const categoryChip = document.getElementById("categoryChip");
  const scoreCounter = document.getElementById("scoreCounter");

  const progressBar = new ProgressBar.Circle("#progress-bar", {
    strokeWidth: 4,
    easing: "linear",
    duration: 15000,
    trailWidth: 1,
    step: function(state, circle) {
      const timeLeft = Math.ceil((1 - circle.value()) * 15);
      circle.setText(timeLeft > 0 ? timeLeft : "Esgotado");

      if (timeLeft <= 5 && timeLeft > 0) {
        circle.path.setAttribute("stroke", "#ff0000");
        document.querySelector("#progress-bar").classList.add("pulsing");
      } else {
        circle.path.setAttribute("stroke", "#3490dc");
        document.querySelector("#progress-bar").classList.remove("pulsing");
      }

      if (timeLeft <= 0)
        handleTimeout();
    },
    svgStyle: { width: "100%", height: "100px" },
  });

  function startTimer() {
    progressBar.set(0);
    progressBar.animate(1);
  }

  function stopTimer() {
    progressBar.stop();
    document.querySelector("#progress-bar").classList.remove("pulsing");
  }

  function handleTimeout() {
    stopTimer();
    skipQuestion();
  }

  function loadQuestion() {
    const question = questions[currentQuestion];
    questionEl.textContent = question.question;
    answersEl.innerHTML = '';
    explanationEl.classList.add("hidden");

    questionChip.textContent = `Pergunta ${currentQuestion + 1}/${quizData.length}`;
    categoryChip.textContent = `Categoria: ${question.category}`;
    scoreCounter.textContent = `Pontua√ß√£o: ${score}`;

    const shuffledAnswers = [...question.answers];
    shuffle(shuffledAnswers);
    correctAnswerIndex = shuffledAnswers.indexOf(question.answers[question.correct]);

    shuffledAnswers.forEach((answer, index) => {
      const button = document.createElement("button");
      button.textContent = answer;
      button.classList.add(
        "w-full",
        "text-left",
        "bg-gray-300",
        "hover:bg-gray-400",
        "py-2",
        "px-4",
        "rounded",
        "transition",
        "duration-300",
        "focus:outline-none",
        "focus:ring-2",
        "focus:ring-blue-500"
      );
      button.setAttribute("aria-label", `Resposta ${index + 1}: ${answer}`);
      button.addEventListener("click", () => selectAnswer(index));
      answersEl.appendChild(button);
    });

    nextQuestionBtn.classList.add("hidden");
    startTimer();
  }

  function selectAnswer(selectedIndex) {
    stopTimer();
    const buttons = answersEl.getElementsByTagName("button");
    for (let button of buttons) {
      button.disabled = true;
      button.classList.remove("hover:bg-gray-600");
    }

    const currentQ = questions[currentQuestion];
    const category = currentQ.category;

    if (!categoryStats[category]) {
      categoryStats[category] = { correct: 0, total: 0 };
    }

    categoryStats[category].total++;

    if (selectedIndex === correctAnswerIndex) {
      buttons[selectedIndex].classList.remove("bg-gray-300", "hover:bg-gray-400");
      buttons[selectedIndex].classList.add("bg-green-500", "text-white");
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 }
      });

      const correctSound = new Audio("public/sounds/correct-answer.webm");
      correctSound.play();
      score++;
      categoryStats[category].correct++;
    } else {
      buttons[selectedIndex].classList.remove("bg-gray-300", "hover:bg-gray-400");
      buttons[selectedIndex].classList.add("bg-red-500", "text-white", "shake");
      buttons[correctAnswerIndex].classList.remove("bg-gray-700", "hover:bg-gray-600");
      buttons[correctAnswerIndex].classList.add("bg-green-500", "text-white");

      document.body.classList.add("flash-red");
      setTimeout(() => {
        document.body.classList.remove("flash-red");
      }, 300);

      const errorSound = new Audio("public/sounds/wrong-answer.webm");
      errorSound.play();
    }

    explanationTextEl.textContent = currentQ.explanation;
    explanationEl.classList.remove("hidden");
    nextQuestionBtn.classList.remove("hidden");

    if (currentQuestion === questions.length - 1) {
      nextQuestionBtn.innerText = "Ver Resultados";
    }
  }

  function skipQuestion() {
    const buttons = answersEl.getElementsByTagName("button");
    for (let button of buttons) {
      button.disabled = true;
      button.classList.remove("hover:bg-gray-600");
    }

    const currentQ = questions[currentQuestion];
    const category = currentQ.category;

    if (!categoryStats[category]) {
      categoryStats[category] = { correct: 0, total: 0 };
    }

    categoryStats[category].total++;

    document.body.classList.add("flash-red");
    setTimeout(() => {
      document.body.classList.remove("flash-red");
    }, 300);

    const errorSound = new Audio("public/sounds/wrong-answer.webm");
    errorSound.play();

    explanationTextEl.textContent = currentQ.explanation;
    explanationEl.classList.remove("hidden");
    nextQuestionBtn.classList.remove("hidden");

    if (currentQuestion === questions.length - 1) {
      nextQuestionBtn.innerText = "Ver Resultados"; // Altera√ß√£o solicitada
    }
  }

  function showResult() {
    quizContainer.classList.add("hidden");
    resultEl.classList.remove("hidden");
    
    const percentage = ((score / quizData.length) * 100).toFixed(2);
    
    scoreEl.textContent = `Voc√™ acertou ${score} de ${quizData.length} perguntas!`;
    percentageEl.textContent = `Taxa de Acerto: ${percentage}%`;
    
    generateCharts();

    confetti({
      particleCount: 300,
      spread: 160,
      origin: { y: 0.6 }
    });
  }

  function generateCharts() {
    const ctxBar = document.getElementById("resultChart").getContext("2d");
    new Chart(ctxBar, {
      type: "bar",
      data: {
        labels: Object.keys(categoryStats),
        datasets: [{
          label: "Acertos",
          data: Object.values(categoryStats).map(cat => cat.correct),
          backgroundColor: "rgba(52, 144, 220, 0.6)",
          borderColor: "rgba(52, 144, 220, 1)",
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          title: {
            display: true,
            text: "Acertos por Categoria"
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const category = context.label;
                const correct = categoryStats[category].correct;
                const total = categoryStats[category].total;
                const percent = ((correct / total) * 100).toFixed(2);
                return `${correct} de ${total} (${percent}%)`;
              }
            }
          },
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            precision: 0,
            title: {
              display: true,
              text: "N√∫mero de Acertos"
            }
          },
          x: {
            title: {
              display: true,
              text: "Categorias"
            }
          }
        }
      }
    });

    const ctxRadar = document.getElementById("radarChart").getContext("2d");
    new Chart(ctxRadar, {
      type: "radar",
      data: {
        labels: Object.keys(categoryStats),
        datasets: [{
          label: "Taxa de Acerto (%)",
          data: Object.values(categoryStats).map(cat => ((cat.correct / cat.total) * 100).toFixed(2)),
          backgroundColor: "rgba(255, 159, 64, 0.2)",
          borderColor: "rgba(255, 159, 64, 1)",
          borderWidth: 1,
          pointBackgroundColor: "rgba(255, 159, 64, 1)",
          pointBorderColor: "#fff",
          pointHoverBackgroundColor: "#fff",
          pointHoverBorderColor: "rgba(255, 159, 64, 1)"
        }]
      },
      options: {
        responsive: true,
        plugins: {
          title: {
            display: true,
            text: "Taxa de Acerto por Categoria"
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const category = context.label;
                const percent = ((categoryStats[category].correct / categoryStats[category].total) * 100).toFixed(2);
                return `${percent}%`;
              }
            }
          },
          legend: {
            display: false
          }
        },
        scales: {
          r: {
            beginAtZero: true,
            max: 100,
            ticks: {
              stepSize: 10
            },
            angleLines: {
              color: "rgba(200, 200, 200, 0.2)"
            },
            grid: {
              color: "rgba(200, 200, 200, 0.2)"
            },
            pointLabels: {
              font: {
                size: 14
              }
            }
          }
        }
      }
    });

    const ctxPie = document.getElementById("pieChart").getContext("2d");
    new Chart(ctxPie, {
      type: "pie",
      data: {
        labels: ["Acertos", "Erros"],
        datasets: [{
          data: [score, quizData.length - score],
          backgroundColor: [
            "rgba(52, 144, 220, 0.6)",
            "rgba(255, 99, 132, 0.6)"
          ],
          borderColor: [
            "rgba(52, 144, 220, 1)",
            "rgba(255, 99, 132, 1)"
          ],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          title: {
            display: true,
            text: "Distribui√ß√£o Geral de Acertos"
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const label = context.label;
                const value = context.parsed;
                const percent = ((value / quizData.length) * 100).toFixed(2);
                return `${label}: ${value} (${percent}%)`;
              }
            }
          },
          legend: {
            position: "bottom"
          }
        }
      }
    });
  }

  function restartQuiz() {
    currentQuestion = 0;
    score = 0;
    categoryStats = {};
    resultEl.classList.add("hidden");
    nextQuestionBtn.innerText = "Pr√≥xima Pergunta";
    document.getElementById("intro").classList.remove("hidden");

    percentageEl.textContent = '';
    
    const charts = ["resultChart", "radarChart", "pieChart"];
    charts.forEach(chartId => {
      const chartElement = document.getElementById(chartId);
      if (chartElement) {
        const chartInstance = Chart.getChart(chartId);
        if (chartInstance) chartInstance.destroy();
      }
    });
  }

  startQuizBtn.addEventListener("click", () => {
    document.getElementById("intro").classList.add("hidden");
    quizContainer.classList.remove("hidden");
    loadQuestion();
  });

  nextQuestionBtn.addEventListener("click", () => {
    currentQuestion++;
    if (currentQuestion < questions.length) {
      loadQuestion();
    } else {
      showResult();
    }
  });

  restartQuizBtn.addEventListener("click", restartQuiz);

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }
})();
